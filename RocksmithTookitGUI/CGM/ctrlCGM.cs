using System;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Windows.Forms;
using RocksmithToolkitLib;
using RocksmithToolkitLib.DLCPackage;

namespace RocksmithToolkitGUI.CGM
{
    //
    // This C# code by COZY1 is a loose initial porting of 
    // AutoHotkey Script by Baoulettes for Custom Guitar Maker 
    //
    public partial class ctrlCGM : UserControl
    {
        private const string MESSAGEBOX_CAPTION = "User Control CGM";
        // Declare global CGM working directory structure variables
        private const string RESOUCESDIR = "\\CGM\\resources";
        private const string TOOLSDIR = RESOUCESDIR + "\\tools";
        private const string IMAGESDIR = RESOUCESDIR + "\\images";
        private const string TMPDIR = RESOUCESDIR + "\\tmp";
        private const string CGMDIR = TMPDIR + "\\cgm";
        private const string CGMSAVE = TMPDIR + "\\cgmsave";
        private const string NEWGUITARPACK = TMPDIR + "\\newguitarpack";
        private const string TMPIMAGES = TMPDIR + "\\images";
        private const string DLCINLAYS = "\\dlc\\Inlays";
        private string RSDIR = "";
        // AppPath can not be used reliably until code is compiled
        // throws unhandled exception errors when MainForm.cs is loaded in design mode
        // added AppPath variable definition elsewhere in code as work around
        // private string AppPath = Application.StartupPath;
        private const string strCgmVers = "0.1.0.0";
        private string strCreatorName = "Your Name Here ";
        private string strGuitarName = "Inlay Name Here";
        private string str24Frets = "0";
        private string strColored = "0";
        private string strIconFile = IMAGESDIR + "\\default_icon.png";
        private string strInlayFile = IMAGESDIR + "\\default_inlay.png";
        private string strExePath;
        private string strSwitches;
        private bool bRet;

        public Platform TargetPlatform // sometimes had to comment out this method to add control
            // to tabpage or form then uncomment to make it work again
        {
            get
            {
                if (cmbPlatform.Items.Count > 0) return new Platform(cmbPlatform.SelectedItem.ToString(), GameVersion.RS2014.ToString());
                else return new Platform(GamePlatform.None, GameVersion.None);
            }
        }

        public string AppId
        {
            // recursive calls burn system clocks and memory
            // consider optimizing code (get rid of) these 
            get { return txtAppId.Text; }
            set { txtAppId.Text = value; }
        }

        public ctrlCGM()
        {
            InitializeComponent();
            //SetStyle(ControlStyles.SupportsTransparentBackColor, true);
        }

        private void ctrlCGM_Load(object sender, EventArgs e)
        {
            try
            {
                // Fill target combo
                var targetPlatform = Enum.GetNames(typeof (GamePlatform)).ToList<string>();
                targetPlatform.Remove("None");
                cmbPlatform.DataSource = targetPlatform;
                cmbPlatform.SelectedItem = GamePlatform.Pc.ToString();

                // Fill in App ID
                // sometimes have to comment out next line
                PopulateAppIdCombo(GameVersion.RS2014);
                AppIdVisibilty();
            }
            catch
            {
                /*For mono compatibility*/
            }

            // setup CGM controls
            txtAppId.DoubleClick += new EventHandler(txtAppId_DoubleClick);
            txtCreator.DoubleClick += new EventHandler(txtCreator_DoubleClick);
            txtGuitar.DoubleClick += new EventHandler(txtInlay_DoubleClick);
            chkFlipX.Click += new EventHandler(chkFlipX_Click);
            chkFlipY.Click += new EventHandler(chkFlipY_Click);
            // fix for transparent labels on picbox positioning method is T&E
            picLogo.Controls.Add(lblCredits1);
            lblCredits1.Location = new System.Drawing.Point(89, 55);
            lblCredits1.BackColor = Color.FromArgb(0, lblCredits1.BackColor);
            picLogo.Controls.Add(lblCredits2);
            lblCredits2.Location = new System.Drawing.Point(68, 76);
            lblCredits2.BackColor = Color.FromArgb(0, lblCredits2.BackColor);
            //
            string AppPath = Application.StartupPath;
            strIconFile = AppPath + strIconFile;
            strInlayFile = AppPath + strInlayFile;
            picIcon.ImageLocation = strIconFile;
            picInlay.ImageLocation = strInlayFile;
            txtCreator.Text = strCreatorName;
            txtGuitar.Text = strGuitarName;

            // this area of code seems to cuase IDE to throw unhandeled
            // exception error when MainForm.cs is opened in design mode
            {
                // Load the CustomGuitarList INI file
                string iniCGL = AppPath + "\\CGM\\CustomGuitarList.ini";
                clsINI objIni = new clsINI();
                if (File.Exists(AppPath + "\\CGM\\CustomGuitarList.ini"))
                {
                    txtRS2014Path.Text = RSDIR = objIni.IniRead(iniCGL, "CustomGuitarMaker", "Rocksmith2014dir");
                    cmbPlatform.SelectedItem = objIni.IniRead(iniCGL, "CustomGuitarMaker", "Platform");
                    txtRS2014Path.ForeColor = Color.Black;
                }
                else
                {
                    bRet = objIni.IniCreate(AppPath + "\\CGM\\CustomGuitarList.ini", true);
                }
            }
        }

        private void PopulateAppIdCombo(GameVersion gameVersion)
        {
            cmbAppId.Items.Clear();
            foreach (var song in SongAppIdRepository.Instance().Select(gameVersion)) cmbAppId.Items.Add(song);

            // DEFAULT  >>>
            // RS2014   = Cherub Rock
            var songAppId = SongAppIdRepository.Instance().Select("248750", gameVersion);
            cmbAppId.SelectedItem = songAppId;
            AppId = songAppId.AppId;
        }

        private void AppIdVisibilty()
        {
            if (cmbPlatform.SelectedItem != null)
            {
                var target = new Platform(cmbPlatform.SelectedItem.ToString(), GameVersion.RS2014.ToString());
                var isPCorMac = target.platform == GamePlatform.Pc || target.platform == GamePlatform.Mac;
                cmbAppId.Enabled = isPCorMac;
                txtAppId.Enabled = isPCorMac;
            }
        }

        private void cmbPlatform_SelectedIndexChanged(object sender, EventArgs e)
        {
            AppIdVisibilty();
        }

        private void cmbAppId_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (cmbAppId.SelectedItem != null) txtAppId.Text = ((SongAppId) cmbAppId.SelectedItem).AppId;
        }

        private void picIcon_Click(object sender, EventArgs e)
        {
            string AppPath = Application.StartupPath;
            var ofd = new OpenFileDialog();
            ofd.Title = "Select a 512x512 (PNG Image) for the button/icon";
            ofd.Filter = "png files|*.png";
            ofd.FilterIndex = 1;
            ofd.InitialDirectory = AppPath + IMAGESDIR;
            ofd.CheckPathExists = true;
            // ofd.RestoreDirectory = true;

            if (ofd.ShowDialog() != DialogResult.OK) return;
            picIcon.ImageLocation = strIconFile = ofd.FileName;
        }

        private void picInlay_Click(object sender, EventArgs e)
        {
            string AppPath = Application.StartupPath;
            var ofd = new OpenFileDialog();
            ofd.Title = "Select a 1024x512 (PNG Image) for the Custom Guitar Inlay";
            ofd.Filter = "png files|*.png";
            ofd.FilterIndex = 1;
            ofd.InitialDirectory = AppPath + IMAGESDIR;
            ofd.CheckPathExists = true;
            // ofd.RestoreDirectory = true;

            if (ofd.ShowDialog() != DialogResult.OK) return;
            picInlay.ImageLocation = strInlayFile = ofd.FileName;
        }

        private void btnRS2014Dir_Click(object sender, EventArgs e)
        {
            var fbd = new FolderBrowserDialog();
            fbd.Description = "Select the RS2014 root directory or another location to store your Custom DLC Inlays.";
            fbd.SelectedPath = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments);
            if (fbd.ShowDialog() != DialogResult.OK) return;
            txtRS2014Path.Text = RSDIR = fbd.SelectedPath;
            txtRS2014Path.ForeColor = Color.Black;
        }

        // convert cgm to png files
        private void btnLoadCGM_Click(object sender, EventArgs e)
        {
            string AppPath = Application.StartupPath;
            var ofd = new OpenFileDialog();
            ofd.Title = "Select a CGM file";
            ofd.Filter = "cgm files|*.cgm";
            ofd.FilterIndex = 1;
            ofd.InitialDirectory = AppPath + RESOUCESDIR + "\\inlays";
            ofd.CheckPathExists = true;
            // ofd.RestoreDirectory = true;

            if (ofd.ShowDialog() != DialogResult.OK) return;
            string strCgmFile = ofd.FileName;
            txtOpenCGM.Text = Path.GetFileName(strCgmFile);
            txtOpenCGM.ForeColor = Color.Black;
            //        
            Cursor.Current = Cursors.WaitCursor;
            bRet = clsCMD.DeleteDir(AppPath + CGMDIR, true);
            bRet = clsCMD.MakeDir(AppPath + CGMDIR);
            bRet = clsCMD.CopyFile(strCgmFile, AppPath + CGMDIR + "\\1.7z", true);
            // unzip the file
            strExePath = AppPath + TOOLSDIR + "\\7za.exe";
            strSwitches = " x \"" + AppPath + CGMDIR + "\\1.7z\"" + " -o\"" + AppPath + CGMDIR + "\\*\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);

            // open the setup.smb INI file
            string iniFile = AppPath + CGMDIR + "\\1\\setup.smb";
            clsINI objIni = new clsINI();
            strCreatorName = objIni.IniRead(iniFile, "Setup", "creatorname");
            strGuitarName = objIni.IniRead(iniFile, "Setup", "guitarname");
            str24Frets = objIni.IniRead(iniFile, "Setup", "24frets");
            strColored = objIni.IniRead(iniFile, "Setup", "coloredinlay");

            txtCreator.ForeColor = Color.Black;
            txtCreator.Text = strCreatorName;
            txtGuitar.ForeColor = Color.Black;
            txtGuitar.Text = strGuitarName;

            // quick reset of all checkboxes
            chk24Fret.Checked = chkColor.Checked = chkFlipX.Checked = chkFlipY.Checked = false;
            if (str24Frets == "1") chk24Fret.Checked = true;
            if (strColored == "1") chkColor.Checked = true;

            // convert the dds files to png with topng.exe
            strExePath = AppPath + TOOLSDIR + "\\topng.exe";
            strSwitches = " -out png \"" + AppPath + CGMDIR + "\\1\\icon.dds\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            strSwitches = " -out png \"" + AppPath + CGMDIR + "\\1\\inlay.dds\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);

            // load png to picBoxes and save paths
            picInlay.ImageLocation = strInlayFile = AppPath + CGMDIR + "\\1\\inlay.png";
            picIcon.ImageLocation = strIconFile = AppPath + CGMDIR + "\\1\\icon.png";
            //
            Cursor.Current = Cursors.Default;
        }

        // convert png to cgm file
        private void btnSaveCGM_Click(object sender, EventArgs e)
        {
            string AppPath = Application.StartupPath;
            var fbd = new FolderBrowserDialog();
            fbd.Description = "Select a location to store your CGM file.";
            fbd.SelectedPath = AppPath + RESOUCESDIR + "\\inlays";
            if (fbd.ShowDialog() != DialogResult.OK) return;
            string strCGMPath = fbd.SelectedPath;
            //
            Cursor.Current = Cursors.WaitCursor;
            var frmPbar = new frmProgress();
            frmPbar.Text = "Custom Guitar Maker";
            frmPbar.lblHeader.Text = "Saving CGM File ... ";
            frmPbar.PbarValue(10);
            // create some tmp folders
            bRet = clsCMD.DeleteDir(AppPath + CGMSAVE, true);
            bRet = clsCMD.MakeDir(AppPath + CGMSAVE);
            frmPbar.PbarFooter("Generating DDS Files ...");
            frmPbar.PbarValue(20);
            // convert png to dds
            strExePath = AppPath + "\\nvdxt.exe";
            strSwitches = " -file \"" + strInlayFile + "\" -prescale 1024 512 -quality_highest -max -32 dxt5 -dxt5 -overwrite -alpha -output \"" + AppPath + CGMSAVE + "\\inlay.dds\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            frmPbar.PbarValue(40);
            strSwitches = " -file \"" + strIconFile + "\" -prescale 512 512 -quality_highest -max -32 dxt5 -dxt5 -overwrite -alpha -output \"" + AppPath + CGMSAVE + "\\icon.dds\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            frmPbar.PbarValue(60);
            // create INI file setup.smb in prefered key order
            string iniFile = AppPath + CGMSAVE + "\\setup.smb";
            clsINI objIni = new clsINI();
            bRet = objIni.IniCreate(iniFile, false);
            bRet = objIni.IniWrite(iniFile, "Setup", "creatorname", txtCreator.Text);
            bRet = objIni.IniWrite(iniFile, "Setup", "guitarname", txtGuitar.Text);
            // quick reset of all checkboxes
            str24Frets = strColored = "0";
            if (chk24Fret.Checked) str24Frets = "1";
            if (chkColor.Checked) strColored = "1";
            frmPbar.PbarValue(70);
            bRet = objIni.IniWrite(iniFile, "Setup", "24frets", str24Frets);
            bRet = objIni.IniWrite(iniFile, "Setup", "coloredinlay", strColored);
            bRet = objIni.IniWrite(iniFile, "Setup", "24frets", str24Frets);
            bRet = objIni.IniWrite(iniFile, "Setup", "cgmvers", strCgmVers);
            bRet = objIni.IniWrite(iniFile, "Setup", "modified", DateTime.Now.ToString("MM/dd/yyyy"));
            frmPbar.PbarFooter("Zipping Files ...");
            frmPbar.PbarValue(80);
            // zip the files up into a *.cgm
            string FileNameCGM = txtGuitar.Text.Replace(" ", "_") + "_" + txtCreator.Text.Replace(" ", "_") + ".cgm";
            // Didn't like the look of this so commented it out
            //  if (chk24Fret.Checked) FileNameCGM = "24_" + FileNameCGM;
            // zip it up
            strExePath = AppPath + TOOLSDIR + "\\7za.exe";
            strSwitches = " a \"" + AppPath + CGMSAVE + "\\" + FileNameCGM + " \"" + " \"" + AppPath + CGMSAVE + "\\*\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            // CopyFile is a workaround for problem with writing zip file to correct folder
            bRet = clsCMD.CopyFile(AppPath + CGMSAVE + "\\" + FileNameCGM, strCGMPath + "\\" + FileNameCGM, true);
            txtOpenCGM.Text = FileNameCGM;
            frmPbar.PbarFooter("All Done ...");
            frmPbar.PbarValue(100);
            Cursor.Current = Cursors.Default;
        }

        // create the custom inlay DLC ... convert png to psarc file
        private void btnCreate_Click(object sender, EventArgs e)
        {
            if (RSDIR == "" | RSDIR == "ERROR")
            {
                MessageBox.Show("Please select a Custom Guitar Inlay storage location first.", MESSAGEBOX_CAPTION, MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }
            if (!Char.IsLetter(txtGuitar.Text.FirstOrDefault()))
            {
                MessageBox.Show("Hey Man!  You will have better luck if your \r\ninlay name begins with a alpha character.", MESSAGEBOX_CAPTION, MessageBoxButtons.OK, MessageBoxIcon.Warning);
                return;
            }
            string AppPath = Application.StartupPath;
            Cursor.Current = Cursors.WaitCursor;
            var frmPbar = new frmProgress();
            frmPbar.Text = "Custom Guitar Maker";
            frmPbar.lblHeader.Text = "Saving DLC Inlay File ... ";

            // get a random filename for the inlay "guitarnamesix"
            string guitarnamesix = clsCMD.RandomName(6);
            // guitarnamesix = "abcdef";  // for debugging

            // create the tmp directory structure
            bRet = clsCMD.DeleteDir(AppPath + TMPIMAGES, true);
            bRet = clsCMD.DeleteDir(AppPath + NEWGUITARPACK, true);
            bRet = clsCMD.MakeDir(AppPath + TMPIMAGES);
            bRet = clsCMD.MakeDir(AppPath + NEWGUITARPACK + "\\assets\\gameplay\\inlay");
            bRet = clsCMD.MakeDir(AppPath + NEWGUITARPACK + "\\flatmodels\\rs");
            bRet = clsCMD.MakeDir(AppPath + NEWGUITARPACK + "\\gamexblocks\\nguitars");
            bRet = clsCMD.MakeDir(AppPath + NEWGUITARPACK + "\\gfxassets\\rewards\\guitar_inlays");
            bRet = clsCMD.MakeDir(AppPath + NEWGUITARPACK + "\\manifests\\guitars");
            bRet = clsCMD.MakeDir(AppPath + NEWGUITARPACK + "\\manifests\\songs_dlc_" + guitarnamesix);
            bRet = clsCMD.MakeDir(RSDIR + DLCINLAYS);
            frmPbar.PbarFooter("Creating DDS Files...");
            frmPbar.PbarValue(10);
            // copy the png files to the appropriate directory for conversion
            // this seems key to producing valid psarc files
            // remember flipx and flipy were applied earlier
            bRet = clsCMD.CopyFile(strInlayFile, AppPath + TMPIMAGES + "\\inlay.png", true);
            bRet = clsCMD.CopyFile(strIconFile, AppPath + TMPIMAGES + "\\icon.png", true);
            // another key ... run topng overwrite to ensure valid png files
            strExePath = AppPath + TOOLSDIR + "\\topng.exe";
            strSwitches = " -overwrite " + AppPath + TMPIMAGES + "\\inlay.png";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            strSwitches = " -overwrite " + AppPath + TMPIMAGES + "\\icon.png";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            // convert png to dds
            strExePath = AppPath + "\\nvdxt.exe";
            strSwitches = " -file \"" + AppPath + TMPIMAGES + "\\inlay.png\"" + " -prescale 1024 512 -quality_highest -max -dxt5 -nomipmap -alpha -output \"" + AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + ".dds\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            frmPbar.PbarValue(20);
            strSwitches = " -file \"" + AppPath + TMPIMAGES + "\\icon.png\"" + " -prescale 512 512 -quality_highest -max -dxt5 -nomipmap -alpha -output " + "\"" + AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + "_512.dds\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            strSwitches = " -file \"" + AppPath + TMPIMAGES + "\\icon.png\"" + " -prescale 256 256 -quality_highest -max -dxt5 -nomipmap -alpha -output " + "\"" + AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + "_256.dds\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            frmPbar.PbarValue(40);
            strSwitches = " -file \"" + AppPath + TMPIMAGES + "\\icon.png\"" + " -prescale 128 128 -quality_highest -max -dxt5 -nomipmap -alpha -output " + "\"" + AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + "_128.dds\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            strSwitches = " -file \"" + AppPath + TMPIMAGES + "\\icon.png\"" + " -prescale 64 64 -quality_highest -max -dxt5 -nomipmap -alpha -output " + "\"" + AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + "_64.dds\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            frmPbar.PbarValue(60);
            // check for 24 fret inlay
            string strNifPatch;
            if (chk24Fret.Checked)
            {
                strNifPatch = "inlay_24fret_" + guitarnamesix + ".dds";
            }
            else
            {
                strNifPatch = "inlay_" + guitarnamesix + ".dds";
            }
            // copy image files to the right places and names for packing
            bRet = clsCMD.CopyFile(AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + ".dds", AppPath + NEWGUITARPACK + "\\assets\\gameplay\\inlay\\" + strNifPatch, true);
            bRet = clsCMD.CopyFile(AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + "_512.dds", AppPath + NEWGUITARPACK + "\\gfxassets\\rewards\\guitar_inlays\\" + "reward_inlay_" + guitarnamesix + "_512.dds", true);
            bRet = clsCMD.CopyFile(AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + "_256.dds", AppPath + NEWGUITARPACK + "\\gfxassets\\rewards\\guitar_inlays\\" + "reward_inlay_" + guitarnamesix + "_256.dds", true);
            bRet = clsCMD.CopyFile(AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + "_128.dds", AppPath + NEWGUITARPACK + "\\gfxassets\\rewards\\guitar_inlays\\" + "reward_inlay_" + guitarnamesix + "_128.dds", true);
            bRet = clsCMD.CopyFile(AppPath + TMPIMAGES + "\\inlay_" + guitarnamesix + "_64.dds", AppPath + NEWGUITARPACK + "\\gfxassets\\rewards\\guitar_inlays\\" + "reward_inlay_" + guitarnamesix + "_64.dds", true);
            // make appid file
            bRet = clsCMD.WriteTextFile(AppPath + NEWGUITARPACK + "\\appid.appid", txtAppId.Text.Trim(), false);

            string strNif1, strNif2, strNif21, strNif22;
            // Magic HEX strings to make the nif file (ok, confirmed)
            if (!chk24Fret.Checked)
            {
                if (!chkColor.Checked)
                {
                    strNif1 = "47616D656272796F2046696C6520466F726D61742C2056657273696F6E2033302E312E302E330A0300011E010000000049000000000000000B00110000004E694461746153747265616D0131013138110000004E694461746153747265616D0130013138110000004E69537472696E67457874726144617461060000004E694D657368120000004E694D6174657269616C50726F7065727479150000004E69566572746578436F6C6F7250726F70657274790F0000004E69416C70686150726F70657274790F0000004E69536F7572636554657874757265130000004E69546578747572696E6750726F7065727479110000004E695A42756666657250726F7065727479060000004E694E6F64650000010002000300000001000200030000000100020003000000010002000300000001000200030000000100020003000000010002000300000001000200030000000100020003000000010002000300000001000200030000000100020003000000010002000300000001000200030000000100020003000000010004000500060007000800090002000300050009000A00710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC0000007100000029000000440000000E0000000F00000024000000280000000E00000008000000BC0000000E0000000E0000009A00000018000000100000000A0000005363656E6520526F6F7407000000696E6C61795F330E0000005573657250726F704275666665720B0000000D0A7A4D6F646531300D0A10000000";
                    strNif2 = "0B0000004D6174657269616C20233205000000494E44455808000000504F534954494F4E08000000544558434F4F524407000000696E6C61795F3407000000696E6C61795F3507000000696E6C61795F3607000000696E6C61795F3707000000696E6C61795F3807000000696E6C61795F3908000000696E6C61795F313008000000696E6C61795F313108000000696E6C61795F313208000000696E6C61795F313308000000696E6C61795F313408000000696E6C61795F313508000000696E6C61795F313608000000696E6C61795F313708000000696E6C61795F31380000000050000000000000000100000000000000040000000200000037040300360402008EDBA1C2D26F80C049382037B18A633FEA6B6F3F01A3A8C2D26F80C06CF22637E7077B3FEA6B6F3F02A3A8C2D36F80406CF22637EB077B3F3A04FB3E8FDBA1C2D36F804049382037B98A633F3A04FB3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000170000000100000002000000FFFFFFFF10009C2727B7B8C850C2A68B5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000483FA5C2000080345A952337DC6A8B400200000001000000000100000001000000060000000000000000000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402002DF799C2D26F80C0AF6318374532483FEA6B6F3F1E14A1C2D26F80C065721F37A7D7603FEA6B6F3F1F14A1C2D36F804065721F37AFD7603F3A04FB3E2EF799C2D36F8040AF6318374932483F3A04FB3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000160000000100000006000000FFFFFFFF100021431FB7B8C850C29D8C5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000A6859DC2000080340AEB1B376F7A8C400200000005000000000100000001000000060000000000000004000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402001E1A92C2D26F80C0609710372BF32C3FEA6B6F3FBD2F99C2D26F80C0DC9D17373B7F453FEA6B6F3FBE2F99C2D36F8040DD9D17373B7F453F3A04FB3E1E1A92C2D36F80406097103727F32C3F3A04FB3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000015000000010000000A000000FFFFFFFF1000E64517B7B8C850C29A8D5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000EEA495C2000080349E1A1437C0628C40020000000900000000010000000100000006000000000000000800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200C6D489C2D26F80C0E4630837C34A103FEA6B6F3FAE5291C2D26F80C09DD10F3729402A3FEA6B6F3FAE5291C2D36F80409ED10F3725402A3F3A04FB3EC6D489C2D36F8040E6630837BF4A103F3A04FB3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000014000000010000000E000000FFFFFFFF1000F5290FB7B8C850C29C8E5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000BA938DC200008034C11A0C3794BB8D40020000000D00000000010000000100000006000000000000000C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200B88581C2D26F80C0CD2700376301E73EEA6B6F3F560D89C2D26F80C0319E0737B9970D3FEA6B6F3F560D89C2D36F8040339E0737B7970D3F3A04FB3EB88581C2D36F8040CE2700376001E73E3A04FB3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000130000000100000012000000FFFFFFFF1000ECE906B7B8C850C2A58F5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000874985C20000803400E303377FDC8D40020000001100000000010000000100000006000000000000001000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BE0372C2D26F80C04E70EF3668FFAB3EEA6B6F3F48BE80C2D26F80C05EC4FE364F9BE13EEA6B6F3F48BE80C2D36F804060C4FE364F9BE13E3A04FB3EC00372C2D36F80405170EF3661FFAB3E3A04FB3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000120000000100000016000000FFFFFFFF1000302CFCB6B8C850C2B2905ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF000000000001000027C079C200008034571AF736D6918E40020000001500000000010000000100000006000000000000001400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200FC9160C2D26F80C08529DE3681D8693E903B6F3FE07470C2D26F80C036E5ED367D6BA73E8E3B6F3FE27470C2D36F804039E5ED36816BA73E82A3FA3EFE9160C2D36F80408929DE368FD8693E82A3FA3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000011000000010000001A000000FFFFFFFF10008441EBB6B8C850C2C6915ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF00000000000100006F8368C2000080345F07E636054C8F400200000019000000000100000001000000060000000000000018000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402008F854EC2D26F80C0D54ACC362E36EE3D903B6F3F1E035FC2D26F80C08D9EDC36C6F05F3E903B6F3F20035FC2D36F8040919EDC36CDF05F3E82A3FA3E92854EC2D36F8040D94ACC365A36EE3D82A3FA3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000010000000010000001E000000FFFFFFFF10004604D9B6B8C850C2E2925ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF000000000001000058C456C200008034B374D43689629040020000001D00000000010000000100000006000000000000001C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BE1E3CC2D26F80C0A514BA366CC2073B903B6F3FB1F64CC2D26F80C001C0CA36C666DA3D903B6F3FB4F64CC2D36F804005C0CA36E366DA3D82A3FA3EC21E3CC2D36F8040A914BA36E4C7073B82A3FA3E010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000F0000000100000022000000FFFFFFFF10006E79C6B6B8C850C205945ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000B98A44C200008034556AC2361C099140020000002100000000010000000100000006000000000000002000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200873A29C2D26F80C02E64A7369CE45E3FA2AFEC3EE08F3AC2D26F80C0FA89B83640387D3FA2AFEC3EE48F3AC2D36F8040FE89B83647387D3F40C08D3C8B3A29C2D36F80403264A736A1E45E3F40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000E0000000100000026000000FFFFFFFF100043AAB3B6B8C850C230955ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF000000000001000036E531C20000803416F7AF36C6F4914002000000250000000001000000010000000600000000000000240000000001000000020000000700000000000000080000000000000000000000500000000000000001000000000000000400000002000000370403003604020041CC15C2D26F80C0F72C94368DE53C3FA2AFEC3EA9AB27C2D26F80C0A9D9A536BE2A5C3FA2AFEC3EADAB27C2D36F8040ADD9A536C62A5C3F40C08D3C44CC15C2D36F8040FA2C943693E53C3F40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000D000000010000002A000000FFFFFFFF1000A987A0B6B8C850C262965ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000F7BB1EC20000803452039D363BFE92400200000029000000000100000001000000060000000000000028000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402005E8201C2D26F80C0B01D80364366193FA2AFEC3E633D14C2D26F80C08FA29236B02B3A3FA2AFEC3E663D14C2D36F804092A29236B62B3A3F40C08D3C618201C2D36F8040B41D80364566193F40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000C000000010000002E000000FFFFFFFF1000CCF38BB6B8C850C2A0975ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000E2DF0AC2000080342160893634B19440020000002D00000000010000000100000006000000000000002C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200EF68DAC1D26F80C0141C5836E4BFEB3EA2AFEC3E00E7FFC1D26F80C0EE267D3664AC163FA2AFEC3E06E7FFC1D36F8040F5267D366BAC163F40C08D3CF368DAC1D36F80401A1C5836EBBFEB3E40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000B0000000100000032000000FFFFFFFF10003E3270B6B8C850C2E5985ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000FA27EDC10000803484A16A364DB9944002000000310000000001000000010000000600000000000000300000000001000000020000000700000000000000080000000000000000000000500000000000000001000000000000000400000002000000370403003604020077C6AFC1D26F80C04DFE2D36C627A13EA2AFEC3E334BD7C1D26F80C0FC075536294CE63EA2AFEC3E374BD7C1D36F8040010855362F4CE63E40C08D3C7AC6AFC1D36F804052FE2D36C627A13E40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000A0000000100000036000000FFFFFFFF10001CD645B6B8C850C2329A5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000D788C3C10000803427834136B2CE9640020000003500000000010000000100000006000000000000003400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200E4E083C1D26F80C0D1A50236AEB4283EA2AFEC3EBBA8ACC1D26F80C06EEA2A3609B49B3EA2AFEC3EBEA8ACC1D36F804073EA2A360FB49B3E40C08D3CE8E083C1D36F8040D2A50236C6B4283E80C08D3C010C00000000000000010000000000000006000000010000001502010000000100020002000300000001020000000300000009000000010000003A000000FFFFFFFF10006A6F1AB6B8C850C28C9B5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000D14498C10000803422C8163642259840020000003900000000010000000100000006000000000000003800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200E61B2DC1D26F80C0F2D1AB353AB6213CA2AFEC3E28C380C1D26F80C08424FF3540CD1D3EA2AFEC3E2CC380C1D36F80408624FF354CCD1D3E80C08D3CE81B2DC1D36F8040ECD1AB353AB6213C80C08D3C010C000000000000000100000000000000060000000100000015020100020003000000000001000200010500000000000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000803F0000803F0000803F000020410000803FFFFFFFFF00000000FFFFFFFF0000FFFFFFFF00000000FFFFFFFFED1000FFFFFFFF00000000FFFFFFFF0104000000FFFFFFFF060000000100000003000000010000FFFFFFFF00000000FFFFFFFF04000900000001410000000032010000000000000000000000000000FFFFFFFF00000000FFFFFFFF0D000200000003000000010000000100000044000000FFFFFFFF1000705DD8B5B8C850C2F19C5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000003E0000003F000000400000004200000043000000FFFFFFFF00000000FFFFFFFF00000000000100001F5157C100008034397BD535D3B19940020000003D00000000010000000100000006000000000000003C0000000001000000020000000700000000000000080000000000000000000000FFFFFFFF00000000FFFFFFFF0800FFFFFFFF00000000FFFFFFFF0F000000000000000000FFFFFFFF10010000000000000000000000000000803F0000000000000000000000000000803F0000000000000000000000000000803F0000803F020000004600000047000000FFFFFFFF10000000450000003B00000037000000330000002F0000002B00000027000000230000001F0000001B00000017000000130000000F0000000B0000000700000003000000000000000100000048000000";
                }
                else
                {
                    strNif1 = "47616D656272796F2046696C6520466F726D61742C2056657273696F6E2033302E312E302E330A0300011E010000000049000000000000000B00110000004E694461746153747265616D0131013138110000004E694461746153747265616D0130013138110000004E69537472696E67457874726144617461060000004E694D657368120000004E694D6174657269616C50726F7065727479150000004E69566572746578436F6C6F7250726F70657274790F0000004E69416C70686150726F70657274790F0000004E69536F7572636554657874757265130000004E69546578747572696E6750726F7065727479110000004E695A42756666657250726F7065727479060000004E694E6F64650000010002000300000001000200030000000100020003000000010002000300000001000200030000000100020003000000010002000300000001000200030000000100020003000000010002000300000001000200030000000100020003000000010002000300000001000200030000000100020003000000010004000500060007000800090002000300050009000A0008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC00000071000000290000000F00000024000000280000000E00000008000000BC0000000E0000000E0000009A00000018000000100000000A0000005363656E6520526F6F7407000000696E6C61795F300E0000005573657250726F704275666665720B0000000D0A7A4D6F646531300D0A10000000";
                    strNif2 = "0B0000004D6174657269616C20233205000000494E44455808000000504F534954494F4E08000000544558434F4F524407000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F300800000000696E6C61795F300800000000696E6C61795F300800000000696E6C61795F300800000000696E6C61795F300800000000696E6C61795F300800000000696E6C61795F300800000000696E6C61795F300800000000696E6C61795F300800000000696E6C61795F300000000050000000000000000100000000000000040000000200000037040300360402008EDBA1C2D26F80C049382037B18A633FEA6B6F3F01A3A8C2D26F80C06CF22637E7077B3FEA6B6F3F02A3A8C2D36F80406CF22637EB077B3F3A04FB3E8FDBA1C2D36F804049382037B98A633F3A04FB3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000170000000100000002000000FFFFFFFF10009C2727B7B8C850C2A68B5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000483FA5C2000080345A952337DC6A8B400200000001000000000100000001000000060000000000000000000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402002DF799C2D26F80C0AF6318374532483FEA6B6F3F1E14A1C2D26F80C065721F37A7D7603FEA6B6F3F1F14A1C2D36F804065721F37AFD7603F3A04FB3E2EF799C2D36F8040AF6318374932483F3A04FB3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000160000000100000006000000FFFFFFFF100021431FB7B8C850C29D8C5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000A6859DC2000080340AEB1B376F7A8C400200000005000000000100000001000000060000000000000004000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402001E1A92C2D26F80C0609710372BF32C3FEA6B6F3FBD2F99C2D26F80C0DC9D17373B7F453FEA6B6F3FBE2F99C2D36F8040DD9D17373B7F453F3A04FB3E1E1A92C2D36F80406097103727F32C3F3A04FB3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000015000000010000000A000000FFFFFFFF1000E64517B7B8C850C29A8D5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000EEA495C2000080349E1A1437C0628C40020000000900000000010000000100000006000000000000000800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200C6D489C2D26F80C0E4630837C34A103FEA6B6F3FAE5291C2D26F80C09DD10F3729402A3FEA6B6F3FAE5291C2D36F80409ED10F3725402A3F3A04FB3EC6D489C2D36F8040E6630837BF4A103F3A04FB3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000014000000010000000E000000FFFFFFFF1000F5290FB7B8C850C29C8E5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000BA938DC200008034C11A0C3794BB8D40020000000D00000000010000000100000006000000000000000C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200B88581C2D26F80C0CD2700376301E73EEA6B6F3F560D89C2D26F80C0319E0737B9970D3FEA6B6F3F560D89C2D36F8040339E0737B7970D3F3A04FB3EB88581C2D36F8040CE2700376001E73E3A04FB3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000130000000100000012000000FFFFFFFF1000ECE906B7B8C850C2A58F5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000874985C20000803400E303377FDC8D40020000001100000000010000000100000006000000000000001000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BE0372C2D26F80C04E70EF3668FFAB3EEA6B6F3F48BE80C2D26F80C05EC4FE364F9BE13EEA6B6F3F48BE80C2D36F804060C4FE364F9BE13E3A04FB3EC00372C2D36F80405170EF3661FFAB3E3A04FB3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000120000000100000016000000FFFFFFFF1000302CFCB6B8C850C2B2905ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF000000000001000027C079C200008034571AF736D6918E40020000001500000000010000000100000006000000000000001400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200FC9160C2D26F80C08529DE3681D8693E903B6F3FE07470C2D26F80C036E5ED367D6BA73E8E3B6F3FE27470C2D36F804039E5ED36816BA73E82A3FA3EFE9160C2D36F80408929DE368FD8693E82A3FA3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000011000000010000001A000000FFFFFFFF10008441EBB6B8C850C2C6915ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF00000000000100006F8368C2000080345F07E636054C8F400200000019000000000100000001000000060000000000000018000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402008F854EC2D26F80C0D54ACC362E36EE3D903B6F3F1E035FC2D26F80C08D9EDC36C6F05F3E903B6F3F20035FC2D36F8040919EDC36CDF05F3E82A3FA3E92854EC2D36F8040D94ACC365A36EE3D82A3FA3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000010000000010000001E000000FFFFFFFF10004604D9B6B8C850C2E2925ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF000000000001000058C456C200008034B374D43689629040020000001D00000000010000000100000006000000000000001C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BE1E3CC2D26F80C0A514BA366CC2073B903B6F3FB1F64CC2D26F80C001C0CA36C666DA3D903B6F3FB4F64CC2D36F804005C0CA36E366DA3D82A3FA3EC21E3CC2D36F8040A914BA36E4C7073B82A3FA3E010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000F0000000100000022000000FFFFFFFF10006E79C6B6B8C850C205945ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000B98A44C200008034556AC2361C099140020000002100000000010000000100000006000000000000002000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200873A29C2D26F80C02E64A7369CE45E3FA2AFEC3EE08F3AC2D26F80C0FA89B83640387D3FA2AFEC3EE48F3AC2D36F8040FE89B83647387D3F40C08D3C8B3A29C2D36F80403264A736A1E45E3F40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000E0000000100000026000000FFFFFFFF100043AAB3B6B8C850C230955ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF000000000001000036E531C20000803416F7AF36C6F4914002000000250000000001000000010000000600000000000000240000000001000000020000000700000000000000080000000000000000000000500000000000000001000000000000000400000002000000370403003604020041CC15C2D26F80C0F72C94368DE53C3FA2AFEC3EA9AB27C2D26F80C0A9D9A536BE2A5C3FA2AFEC3EADAB27C2D36F8040ADD9A536C62A5C3F40C08D3C44CC15C2D36F8040FA2C943693E53C3F40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000D000000010000002A000000FFFFFFFF1000A987A0B6B8C850C262965ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000F7BB1EC20000803452039D363BFE92400200000029000000000100000001000000060000000000000028000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402005E8201C2D26F80C0B01D80364366193FA2AFEC3E633D14C2D26F80C08FA29236B02B3A3FA2AFEC3E663D14C2D36F804092A29236B62B3A3F40C08D3C618201C2D36F8040B41D80364566193F40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000C000000010000002E000000FFFFFFFF1000CCF38BB6B8C850C2A0975ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000E2DF0AC2000080342160893634B19440020000002D00000000010000000100000006000000000000002C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200EF68DAC1D26F80C0141C5836E4BFEB3EA2AFEC3E00E7FFC1D26F80C0EE267D3664AC163FA2AFEC3E06E7FFC1D36F8040F5267D366BAC163F40C08D3CF368DAC1D36F80401A1C5836EBBFEB3E40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000B0000000100000032000000FFFFFFFF10003E3270B6B8C850C2E5985ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000FA27EDC10000803484A16A364DB9944002000000310000000001000000010000000600000000000000300000000001000000020000000700000000000000080000000000000000000000500000000000000001000000000000000400000002000000370403003604020077C6AFC1D26F80C04DFE2D36C627A13EA2AFEC3E334BD7C1D26F80C0FC075536294CE63EA2AFEC3E374BD7C1D36F8040010855362F4CE63E40C08D3C7AC6AFC1D36F804052FE2D36C627A13E40C08D3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000A0000000100000036000000FFFFFFFF10001CD645B6B8C850C2329A5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000D788C3C10000803427834136B2CE9640020000003500000000010000000100000006000000000000003400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200E4E083C1D26F80C0D1A50236AEB4283EA2AFEC3EBBA8ACC1D26F80C06EEA2A3609B49B3EA2AFEC3EBEA8ACC1D36F804073EA2A360FB49B3E40C08D3CE8E083C1D36F8040D2A50236C6B4283E80C08D3C010C00000000000000010000000000000006000000010000001502010000000100020002000300000001020000000300000009000000010000003A000000FFFFFFFF10006A6F1AB6B8C850C28C9B5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F0500000042000000400000003F0000003E00000043000000FFFFFFFF00000000FFFFFFFF0000000000010000D14498C10000803422C8163642259840020000003900000000010000000100000006000000000000003800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200E61B2DC1D26F80C0F2D1AB353AB6213CA2AFEC3E28C380C1D26F80C08424FF3540CD1D3EA2AFEC3E2CC380C1D36F80408624FF354CCD1D3E80C08D3CE81B2DC1D36F8040ECD1AB353AB6213C80C08D3C010C000000000000000100000000000000060000000100000015020100020003000000000001000200010500000000000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000803F0000803F0000803F000020410000803FFFFFFFFF00000000FFFFFFFF0000FFFFFFFF00000000FFFFFFFFED1000FFFFFFFF00000000FFFFFFFF0104000000FFFFFFFF060000000100000003000000010000FFFFFFFF00000000FFFFFFFF04000900000001410000000032010000000000000000000000000000FFFFFFFF00000000FFFFFFFF0D000200000003000000010000000100000044000000FFFFFFFF1000705DD8B5B8C850C2F19C5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000003E0000003F000000400000004200000043000000FFFFFFFF00000000FFFFFFFF00000000000100001F5157C100008034397BD535D3B19940020000003D00000000010000000100000006000000000000003C0000000001000000020000000700000000000000080000000000000000000000FFFFFFFF00000000FFFFFFFF0800FFFFFFFF00000000FFFFFFFF0F000000000000000000FFFFFFFF10010000000000000000000000000000803F0000000000000000000000000000803F0000000000000000000000000000803F0000803F020000004600000047000000FFFFFFFF10000000450000003B00000037000000330000002F0000002B00000027000000230000001F0000001B00000017000000130000000F0000000B0000000700000003000000000000000100000048000000";
                }
            }
            else
            {
                if (!chkColor.Checked)
                {
                    strNif1 = "47616D656272796F2046696C6520466F726D61742C2056657273696F6E2033302E312E302E330A0300011E01000000006D000000000000000B00110000004E694461746153747265616D0131013138110000004E694461746153747265616D0130013138120000004E694D6174657269616C50726F7065727479060000004E694D657368110000004E69537472696E67457874726144617461150000004E69566572746578436F6C6F7250726F70657274790F0000004E69416C70686150726F70657274790F0000004E69536F7572636554657874757265130000004E69546578747572696E6750726F7065727479110000004E695A42756666657250726F7065727479060000004E694E6F64650000010002000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010002000500060007000800090004000300050009000A00710000002900000044000000B4000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC0000007100000029000000440000000E0000000F00000024000000280000000E00000008000000BC0000000E0000000E000000BE00000022000000170000000A0000005363656E6520526F6F7408000000696E6C61795F32300E0000005573657250726F704275666665720B0000000D0A7A4D6F646531300D0A17000000";
                    strNif21 = "05000000696E6C617905000000494E44455808000000504F534954494F4E08000000544558434F4F524407000000696E6C61795F3107000000696E6C61795F3207000000696E6C61795F3307000000696E6C61795F3407000000696E6C61795F3507000000696E6C61795F3607000000696E6C61795F3707000000696E6C61795F3807000000696E6C61795F3908000000696E6C61795F313008000000696E6C61795F313108000000696E6C61795F313208000000696E6C61795F313308000000696E6C61795F313408000000696E6C61795F313508000000696E6C61795F313608000000696E6C61795F313708000000696E6C61795F313808000000696E6C61795F313908000000696E6C61795F323108000000696E6C61795F323208000000696E6C61795F323308000000696E6C61795F32340E0000006D6174657269616C686F6C64657209000000686967686C69676874000000005000000000000000010000000000000004000000020000003704030036040200E43615BFA0843A3F000000000000000000000000E43615BFA0843ABF00000000000000000000803FE436153FA0843A3F000000000000803F00000000E436153FA0843ABF000000000000803F0000803F010C000000000000000100000000000000060000000100000015020100030002000100000001000200012100000000000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000803F0000803F0000803F000020413333B33E2000000000000000FFFFFFFF100000000000A2203E4251C79AC1000000B400000080FFFF7FBF000000000000803F00000000FFFF7F3F00000000000000B40000803F0400000002000000660000006400000063000000FFFFFFFF00000000FFFFFFFF000000000001000000000000000000000000000012DC6E3F0200000001000000000100000001000000060000000000000000000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402002D0FD2C28AB224C030BA4D37ED427F3F71CE5C3F2D0FD2C294B22440663A5037EE427F3F9E820C3F6E35CDC2ED678240043C4B37BE46733F3E29EA3E6D35CDC2EB6782C00A3C4B37B746733F703C743F010C0000000000000001000000000000000600000001000000150201000000010002000200030000000102000000030000001F0000000100000006000000FFFFFFFF1000CC7F51B7B8C850C261865ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100004DA2CFC20000003535BB4D37990E88400200000005000000000100000001000000060000000000000004000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402006857C6C2A9CB50C036C543371A185E3F5F8E673FFD6DCCC2A9CB50C025D24937F259713F5F8E673FFE6DCCC2E7783D40F26C4B37F259713F8E78063F6957C6C2E7783D40056045371A185E3F8E78063F010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000001E000000010000000A000000FFFFFFFF1000BC8A4BB7B8C850C229875ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000B362C9C210961ABE14994737D7AE5D40020000000900000000010000000100000006000000000000000800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BC75BFC29FAD3BC0C2A83C3719304E3F8C68623FF88FC5C2EB6782C04AAC43374F2B5C3F703C743FF98FC5C2ED67824045AC43374F2B5C3F3E29EA3EBD75BFC2A2C42D4036BE3E3719304E3F924C0A3F010C0000000000000001000000000000000600000001000000150201000000010002000200030000000102000000030000001D000000010000000E000000FFFFFFFF100030B044B7B8C850C205885ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000DA82C2C200000035862A4037AA3E8B40020000000D00000000010000000100000006000000000000000C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200D856B8C2EB6782C0C1893637EB263E3F703C743F4CAEBEC29FAD3BC0A8E23B374F434C3F8C68623F4DAEBEC2A2C42D4019F83D3754434C3F924C0A3FD956B8C209256C40E4DB3637EF263E3FF42FF63E010C0000000000000001000000000000000600000001000000150201000000010002000200030000000102000000030000001C0000000100000012000000FFFFFFFF10005BC93CB7B8C850C29C7421BD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100009282BBC2685645BEED403A37C6328640020000001100000000010000000100000006000000000000001000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200716AA9C2EB6782C060B82737481E1C3F5BDB753F973CB0C2957645C009AB2D3791DE2B3FEAC9643F983CB0C2726A754047B12E3769342C3F9296F13E726AA9C2ED67824060B827374D1E1C3F1467ED3E010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000001B0000000100000016000000FFFFFFFF100067742EB7B8C850C2BB8A5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF000000000001000084D3ACC200000035D4342B37BC5C8D400200000015000000000100000001000000060000000000000014000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402008EDBA1C2EB6782C049382037C8B70A3F703C743F01A3A8C2EB6782C06CF226371F531A3F5BDB753F02A3A8C2ED6782406CF2263725531A3F1467ED3E8FDBA1C2ED67824049382037C8B70A3F3E29EA3E010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000001A000000010000001A000000FFFFFFFF10009C2727B7B8C850C2AD8B5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000483FA5C2000000355A952337CB3B8D400200000019000000000100000001000000060000000000000018000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402002DF799C2EB6782C0AF631837EB18F13E703C743F1E14A1C2EB6782C065721F37A1EC083F703C743F1F14A1C2ED67824065721F37A3EC083F3E29EA3E2EF799C2A8BF644077CE1837EB18F13E0CCBF93E010C00000000000000010000000000000006000000010000001502010000000100020002000300000001020000000300000019000000010000001E000000FFFFFFFF100021431FB7B8C850C2A48C5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000A6859DC2000000350AEB1B37E5478E40020000001D00000000010000000100000006000000000000001C000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402001E1A92C2EB6782C060971037F0E3CC3E703C743FBD2F99C2EB6782C0DC9D17379B82ED3E703C743FBE2F99C2A8BF6440A50818379B82ED3E0CCBF93E1E1A92C2ED67824060971037F0E3CC3E3E29EA3E010C000000000000000100000000000000060000000100000015020100000001000200020003000000010200000003000000180000000100000022000000FFFFFFFF1000E6C516B7B8C850C2A08D5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000EEA495C2000000350250143783308E40020000002100000000010000000100000006000000000000002000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200C6D489C2EB6782C0E4630837D0CEA63E703C743FAE5291C2EB6782C09DD10F37A54DC93E703C743FAE5291C2ED6782409ED10F37A54DC93E3E29EA3EC6D489C2ED678240E6630837D0CEA63E3E29EA3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000170000000100000026000000FFFFFFFF1000F5290FB7B8C850C2A38E5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000BA938DC200000035C11A0C3702858F40020000002500000000010000000100000006000000000000002400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200B88581C2075E73C068DBFF36FB8C803ED0FB6F3F560D89C2EB6782C0319E07378538A33E703C743F560D89C2ED678240339E07378538A33E3E29EA3EB88581C2FEB97640B6560037FB8C803E3C07F13E010C00000000000000010000000000000006000000010000001502010000000100020002000300000001020000000300000016000000010000002A000000FFFFFFFF1000ECE906B7B8C850C2AC8F5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000874985C200000035F4C5033784A58F40020000002900000000010000000100000006000000000000002800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BE0372C2EB6782C04E70EF361CB0323E703C743F48BE80C2075E73C02C50FE365EED793ED0FB6F3F48BE80C2FEB976403022FF365EED793E3C07F13EC00372C2ED6782405170EF361CB0323E3E29EA3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000015000000010000002E000000FFFFFFFF1000302CFCB6B8C850C2B9905ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF000000000001000027C079C2000000353F49F7369E589040020000002D00000000010000000100000006000000000000002C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200FC9160C21F2276C0C0C7DD36CEBBC43D6DA8703FE07470C2EB6782C036E5ED3694832B3E703C743FE27470C2ED67824039E5ED3694832B3E3E29EA3EFE9160C2C98D7440D295DE36EDBBC43D6816F23E010C000000000000000100000000000000060000000100000015020100000001000200020003000000010200000003000000140000000100000032000000FFFFFFFF10008441EBB6B8C850C2CD915ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100006F8368C2000000357CD6E536841091400200000031000000000100000001000000060000000000000030000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402008F854EC2EB6782C0D54ACC36B738743C703C743F1E035FC2212276C0C73CDC36BD62B63D6DA8703F20035FC2C78D7440DB0ADD36CD62B63D6816F23E92854EC2F56068403B08CD36E539743CFA05F83E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000130000000100000036000000FFFFFFFF1000290FD9B6B8C850C24019FABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF000000000001000058C456C2781002BED8AAD43631868E40020000003500000000010000000100000006000000000000003400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BE1E3CC2EB6782C0A514BA36CCC5683F8A6AF53EB1F64CC2EB6782C001C0CA3628ED7C3F8A6AF53EB4F64CC2F5606840657DCB362DED7C3F706E053DC21E3CC2ED678240A914BA36D1C5683F007BDF3B010C00000000000000010000000000000006000000010000001502010000000100020002000300000001020000000300000012000000010000003A000000FFFFFFFF10006E79C6B6B8C850C20C945ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000B98A44C20000003505C9C2363FC89240020000003900000000010000000100000006000000000000003800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200873A29C2EB6782C02E64A736282B523F8A6AF53EE08F3AC2C0624BC07A0BB7368CE8663F50C8DA3EE48F3AC2A24F794099D6B83691E8663FC0368D3C8B3A29C2A24F7940CDB0A7362B2B523FC0368D3C010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000011000000010000003E000000FFFFFFFF1000F7B1B3B6B8C850C290E6D0BC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF000000000001000036E531C24003B8BD641DB036D3289140020000003D00000000010000000100000006000000000000003C0000000001000000020000000700000000000000080000000000000000000000500000000000000001000000000000000400000002000000370403003604020041CC15C23E885FC0A734933650EB3A3F4E20E43EA9AB27C2EB6782C0A9D9A536E54D503F8A6AF53EADAB27C2EB166F405D6AA636EB4D503F8010D93C44CC15C2B078664011F7943652EB3A3F10820C3D010C000000000000000100000000000000060000000100000015020100000001000200020003000000010200000003000000100000000100000042000000FFFFFFFF10003596A0B6B8C850C248B714BD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000F7BB1EC258C72DBE82CF9C367CFA8F400200000041000000000100000001000000060000000000000040000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402005E8201C2EB6782C0B01D8036B4A4223F8A6AF53E633D14C23E885FC03FAA9136100E393F4E20E43E663D14C2B0786640AA6C9336B9793A3FE0D4063D618201C274AC6C407BBE8036B6A4223FE0FDEA3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000F0000000100000046000000FFFFFFFF1000F6038CB6B8C850C2E02D1FBD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000E2DF0AC2101B41BE2DC58936EE319140020000004500000000010000000100000006000000000000004400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200EF68DAC1EB6782C0141C58364B590A3F8A6AF53E00E7FFC188E147C03CFB793673C7203F3028D93E06E7FFC174AC6C4083687E3677C7203FE0FDEA3CF368DAC1ED6782401A1C58364E590A3F007BDF3B010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000E000000010000004A000000FFFFFFFF10003E326EB6B8C850C2EC985ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000FA27EDC1000000354C426B36786D964002000000490000000001000000010000000600000000000000480000000001000000020000000700000000000000080000000000000000000000500000000000000001000000000000000400000002000000370403003604020077C6AFC16F2355C038832B3629AFE13E404EDF3E334BD7C16D2355C0E68C52360A7C083F404EDF3E374BD7C1472E68406A8556360C7C083F802A063D7AC6AFC1452E6840BC7B2F3629AFE13E802A063D010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000D000000010000004E000000FFFFFFFF10009BBC45B6B8C850C2A07FDE3B000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000D788C3C1C056183E5104413661888840020000004D00000000010000000100000006000000000000004C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200E4E083C131742BC0DBFEFB351F29AD3E06F9CB3EBBA8ACC131742BC00A442636A5F4DD3E06F9CB3EBEA8ACC186136A409C4E2C36AAF4DD3E2044FE3CE8E083C186136A40FB0904362829AD3E2044FE3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000C0000000100000052000000FFFFFFFF10008C1B1AB6B8C850C2F088583D000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000D14498C1547DFA3E05271536301E8240020000005100000000010000000100000006000000000000005000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200E61B2DC178F85CC072ACA735DEDB6D3E2AF0E23E28C380C178F85CC004FFFA359E6EA93E2AF0E23E2CC380C12CAA3440F3BD0336A46EA93E50A7A23DE81B2DC19CDC4E40536FB135DEDB6D3E901B643D010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000B0000000100000056000000FFFFFFFF10003A83D8B5B8C850C20481E7BC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100001F5157C1C0BDE1BD2C94D735E04188400200000055000000000100000001000000060000000000000054000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402009A57A3C03C8C5EC0E54A1B358173003E6EABE33E6EE026C14CD067C016A7A235D566663E92F7E73E6EE026C19CDC4E401349";
                    strNif22 = "AB35D566663E901B643D9A57A3C0DE7E2940C34336358173003ED05FB73D010C0000000000000001000000000000000600000001000000150201000000010002000200030000000102000000030000000A000000010000005A000000FFFFFFFF1000D4EE7DB5B8C850C2A0B522BD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100003B8CF8C0809D47BE86EE7835E8E08A40020000005900000000010000000100000006000000000000005800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200927EA63F3E8C5EC080DEFEB2F67EBA3B6EABE33EA8E096C03C8C5EC0E6371035E2FCF13D6EABE33EA8E096C0DE7E2940C4302B35E2FCF13DD05FB73D907EA63F07E92B40F2099433FD7EBA3B00E5B23D010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000009000000010000005E000000FFFFFFFF1000D09F0EB4B8C850C2B8F888BD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100000782DABFDC8CCABED039A334F2CC8940020000005D00000000010000000100000006000000000000005C000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402000704B1C2967645C0AB222E376E9D2D3F2ECB643F688FB7C2EC6782C0285C3537223A3C3F703C743F698FB7C208256C4093733637223A3C3FF42FF63E0804B1C2716A7540B8D82F37739D2D3FD2AAF13E010C000000000000000100000000000000060000000100000015020100000001000200020003000000010500000000000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000803F0000803F0000803F000020410000803FFFFFFFFF00000000FFFFFFFF0000FFFFFFFF00000000FFFFFFFFED1000FFFFFFFF00000000FFFFFFFF0104000000FFFFFFFF060000000100000003000000010000FFFFFFFF00000000FFFFFFFF04000900000001650000000032010000000000000000000000000000FFFFFFFF00000000FFFFFFFF0D000200000003000000010000000100000068000000FFFFFFFF10007D1136B7B8C850C2D4A3F2BC000080B400000000000080BF000080BF0000000000008034000000000000803F000000000000803F050000006200000063000000640000006600000067000000FFFFFFFF00000000FFFFFFFF0000000000010000B849B4C27056F6BD1F4B32377CF5884002000000610000000001000000010000000600000000000000600000000001000000020000000700000000000000080000000000000000000000FFFFFFFF00000000FFFFFFFF0800FFFFFFFF00000000FFFFFFFF0F000000000000000000FFFFFFFF10010000000000000000000000000000803F0000000000000000000000000000803F0000000000000000000000000000803F0000803F020000006A0000006B000000FFFFFFFF19000000690000005F0000005B00000057000000530000004F0000004B00000047000000430000003F0000003B00000037000000330000002F0000002B00000027000000230000001F0000001B00000017000000130000000F0000000B000000070000000300000000000000010000006C000000";
                    strNif2 = strNif21 + strNif22;
                }
                else
                {
                    strNif1 = "47616D656272796F2046696C6520466F726D61742C2056657273696F6E2033302E312E302E330A0300011E01000000006D000000000000000B00110000004E694461746153747265616D0131013138110000004E694461746153747265616D0130013138120000004E694D6174657269616C50726F7065727479060000004E694D657368110000004E69537472696E67457874726144617461150000004E69566572746578436F6C6F7250726F70657274790F0000004E69416C70686150726F70657274790F0000004E69536F7572636554657874757265130000004E69546578747572696E6750726F7065727479110000004E695A42756666657250726F7065727479060000004E694E6F64650000010002000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010004000300000001000400030000000100040003000000010002000500060007000800090004000300050009000A00710000002900000044000000B4000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC000000710000002900000008000000BC0000007100000029000000440000000E0000000F00000024000000280000000E00000008000000BC0000000E0000000E000000BE00000022000000170000000A0000005363656E6520526F6F7408000000696E6C61795F32300E0000005573657250726F704275666665720B0000000D0A7A4D6F646531300D0A17000000";
                    strNif21 = "05000000696E6C617905000000494E44455808000000504F534954494F4E08000000544558434F4F524407000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3007000000696E6C61795F3008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F303008000000696E6C61795F30300E0000006D6174657269616C686F6C64657209000000686967686C69676874000000005000000000000000010000000000000004000000020000003704030036040200E43615BFA0843A3F000000000000000000000000E43615BFA0843ABF00000000000000000000803FE436153FA0843A3F000000000000803F00000000E436153FA0843ABF000000000000803F0000803F010C000000000000000100000000000000060000000100000015020100030002000100000001000200012100000000000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000803F0000803F0000803F000020413333B33E2000000000000000FFFFFFFF100000000000A2203E4251C79AC1000000B400000080FFFF7FBF000000000000803F00000000FFFF7F3F00000000000000B40000803F0400000002000000660000006400000063000000FFFFFFFF00000000FFFFFFFF000000000001000000000000000000000000000012DC6E3F0200000001000000000100000001000000060000000000000000000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402002D0FD2C28AB224C030BA4D37ED427F3F71CE5C3F2D0FD2C294B22440663A5037EE427F3F9E820C3F6E35CDC2ED678240043C4B37BE46733F3E29EA3E6D35CDC2EB6782C00A3C4B37B746733F703C743F010C0000000000000001000000000000000600000001000000150201000000010002000200030000000102000000030000001F0000000100000006000000FFFFFFFF1000CC7F51B7B8C850C261865ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100004DA2CFC20000003535BB4D37990E88400200000005000000000100000001000000060000000000000004000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402006857C6C2A9CB50C036C543371A185E3F5F8E673FFD6DCCC2A9CB50C025D24937F259713F5F8E673FFE6DCCC2E7783D40F26C4B37F259713F8E78063F6957C6C2E7783D40056045371A185E3F8E78063F010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000001E000000010000000A000000FFFFFFFF1000BC8A4BB7B8C850C229875ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000B362C9C210961ABE14994737D7AE5D40020000000900000000010000000100000006000000000000000800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BC75BFC29FAD3BC0C2A83C3719304E3F8C68623FF88FC5C2EB6782C04AAC43374F2B5C3F703C743FF98FC5C2ED67824045AC43374F2B5C3F3E29EA3EBD75BFC2A2C42D4036BE3E3719304E3F924C0A3F010C0000000000000001000000000000000600000001000000150201000000010002000200030000000102000000030000001D000000010000000E000000FFFFFFFF100030B044B7B8C850C205885ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000DA82C2C200000035862A4037AA3E8B40020000000D00000000010000000100000006000000000000000C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200D856B8C2EB6782C0C1893637EB263E3F703C743F4CAEBEC29FAD3BC0A8E23B374F434C3F8C68623F4DAEBEC2A2C42D4019F83D3754434C3F924C0A3FD956B8C209256C40E4DB3637EF263E3FF42FF63E010C0000000000000001000000000000000600000001000000150201000000010002000200030000000102000000030000001C0000000100000012000000FFFFFFFF10005BC93CB7B8C850C29C7421BD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100009282BBC2685645BEED403A37C6328640020000001100000000010000000100000006000000000000001000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200716AA9C2EB6782C060B82737481E1C3F5BDB753F973CB0C2957645C009AB2D3791DE2B3FEAC9643F983CB0C2726A754047B12E3769342C3F9296F13E726AA9C2ED67824060B827374D1E1C3F1467ED3E010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000001B0000000100000016000000FFFFFFFF100067742EB7B8C850C2BB8A5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF000000000001000084D3ACC200000035D4342B37BC5C8D400200000015000000000100000001000000060000000000000014000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402008EDBA1C2EB6782C049382037C8B70A3F703C743F01A3A8C2EB6782C06CF226371F531A3F5BDB753F02A3A8C2ED6782406CF2263725531A3F1467ED3E8FDBA1C2ED67824049382037C8B70A3F3E29EA3E010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000001A000000010000001A000000FFFFFFFF10009C2727B7B8C850C2AD8B5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000483FA5C2000000355A952337CB3B8D400200000019000000000100000001000000060000000000000018000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402002DF799C2EB6782C0AF631837EB18F13E703C743F1E14A1C2EB6782C065721F37A1EC083F703C743F1F14A1C2ED67824065721F37A3EC083F3E29EA3E2EF799C2A8BF644077CE1837EB18F13E0CCBF93E010C00000000000000010000000000000006000000010000001502010000000100020002000300000001020000000300000019000000010000001E000000FFFFFFFF100021431FB7B8C850C2A48C5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000A6859DC2000000350AEB1B37E5478E40020000001D00000000010000000100000006000000000000001C000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402001E1A92C2EB6782C060971037F0E3CC3E703C743FBD2F99C2EB6782C0DC9D17379B82ED3E703C743FBE2F99C2A8BF6440A50818379B82ED3E0CCBF93E1E1A92C2ED67824060971037F0E3CC3E3E29EA3E010C000000000000000100000000000000060000000100000015020100000001000200020003000000010200000003000000180000000100000022000000FFFFFFFF1000E6C516B7B8C850C2A08D5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000EEA495C2000000350250143783308E40020000002100000000010000000100000006000000000000002000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200C6D489C2EB6782C0E4630837D0CEA63E703C743FAE5291C2EB6782C09DD10F37A54DC93E703C743FAE5291C2ED6782409ED10F37A54DC93E3E29EA3EC6D489C2ED678240E6630837D0CEA63E3E29EA3E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000170000000100000026000000FFFFFFFF1000F5290FB7B8C850C2A38E5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000BA938DC200000035C11A0C3702858F40020000002500000000010000000100000006000000000000002400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200B88581C2075E73C068DBFF36FB8C803ED0FB6F3F560D89C2EB6782C0319E07378538A33E703C743F560D89C2ED678240339E07378538A33E3E29EA3EB88581C2FEB97640B6560037FB8C803E3C07F13E010C00000000000000010000000000000006000000010000001502010000000100020002000300000001020000000300000016000000010000002A000000FFFFFFFF1000ECE906B7B8C850C2AC8F5ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000874985C200000035F4C5033784A58F40020000002900000000010000000100000006000000000000002800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BE0372C2EB6782C04E70EF361CB0323E703C743F48BE80C2075E73C02C50FE365EED793ED0FB6F3F48BE80C2FEB976403022FF365EED793E3C07F13EC00372C2ED6782405170EF361CB0323E3E29EA3E010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000015000000010000002E000000FFFFFFFF1000302CFCB6B8C850C2B9905ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF000000000001000027C079C2000000353F49F7369E589040020000002D00000000010000000100000006000000000000002C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200FC9160C21F2276C0C0C7DD36CEBBC43D6DA8703FE07470C2EB6782C036E5ED3694832B3E703C743FE27470C2ED67824039E5ED3694832B3E3E29EA3EFE9160C2C98D7440D295DE36EDBBC43D6816F23E010C000000000000000100000000000000060000000100000015020100000001000200020003000000010200000003000000140000000100000032000000FFFFFFFF10008441EBB6B8C850C2CD915ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100006F8368C2000000357CD6E536841091400200000031000000000100000001000000060000000000000030000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402008F854EC2EB6782C0D54ACC36B738743C703C743F1E035FC2212276C0C73CDC36BD62B63D6DA8703F20035FC2C78D7440DB0ADD36CD62B63D6816F23E92854EC2F56068403B08CD36E539743CFA05F83E010C000000000000000100000000000000060000000100000015020100020003000000000001000200010200000003000000130000000100000036000000FFFFFFFF1000290FD9B6B8C850C24019FABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF000000000001000058C456C2781002BED8AAD43631868E40020000003500000000010000000100000006000000000000003400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200BE1E3CC2EB6782C0A514BA36CCC5683F8A6AF53EB1F64CC2EB6782C001C0CA3628ED7C3F8A6AF53EB4F64CC2F5606840657DCB362DED7C3F706E053DC21E3CC2ED678240A914BA36D1C5683F007BDF3B010C00000000000000010000000000000006000000010000001502010000000100020002000300000001020000000300000012000000010000003A000000FFFFFFFF10006E79C6B6B8C850C20C945ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000B98A44C20000003505C9C2363FC89240020000003900000000010000000100000006000000000000003800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200873A29C2EB6782C02E64A736282B523F8A6AF53EE08F3AC2C0624BC07A0BB7368CE8663F50C8DA3EE48F3AC2A24F794099D6B83691E8663FC0368D3C8B3A29C2A24F7940CDB0A7362B2B523FC0368D3C010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000011000000010000003E000000FFFFFFFF1000F7B1B3B6B8C850C290E6D0BC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF000000000001000036E531C24003B8BD641DB036D3289140020000003D00000000010000000100000006000000000000003C0000000001000000020000000700000000000000080000000000000000000000500000000000000001000000000000000400000002000000370403003604020041CC15C23E885FC0A734933650EB3A3F4E20E43EA9AB27C2EB6782C0A9D9A536E54D503F8A6AF53EADAB27C2EB166F405D6AA636EB4D503F8010D93C44CC15C2B078664011F7943652EB3A3F10820C3D010C000000000000000100000000000000060000000100000015020100000001000200020003000000010200000003000000100000000100000042000000FFFFFFFF10003596A0B6B8C850C248B714BD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000F7BB1EC258C72DBE82CF9C367CFA8F400200000041000000000100000001000000060000000000000040000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402005E8201C2EB6782C0B01D8036B4A4223F8A6AF53E633D14C23E885FC03FAA9136100E393F4E20E43E663D14C2B0786640AA6C9336B9793A3FE0D4063D618201C274AC6C407BBE8036B6A4223FE0FDEA3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000F0000000100000046000000FFFFFFFF1000F6038CB6B8C850C2E02D1FBD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000E2DF0AC2101B41BE2DC58936EE319140020000004500000000010000000100000006000000000000004400000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200EF68DAC1EB6782C0141C58364B590A3F8A6AF53E00E7FFC188E147C03CFB793673C7203F3028D93E06E7FFC174AC6C4083687E3677C7203FE0FDEA3CF368DAC1ED6782401A1C58364E590A3F007BDF3B010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000E000000010000004A000000FFFFFFFF10003E326EB6B8C850C2EC985ABC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000FA27EDC1000000354C426B36786D964002000000490000000001000000010000000600000000000000480000000001000000020000000700000000000000080000000000000000000000500000000000000001000000000000000400000002000000370403003604020077C6AFC16F2355C038832B3629AFE13E404EDF3E334BD7C16D2355C0E68C52360A7C083F404EDF3E374BD7C1472E68406A8556360C7C083F802A063D7AC6AFC1452E6840BC7B2F3629AFE13E802A063D010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000D000000010000004E000000FFFFFFFF10009BBC45B6B8C850C2A07FDE3B000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000D788C3C1C056183E5104413661888840020000004D00000000010000000100000006000000000000004C00000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200E4E083C131742BC0DBFEFB351F29AD3E06F9CB3EBBA8ACC131742BC00A442636A5F4DD3E06F9CB3EBEA8ACC186136A409C4E2C36AAF4DD3E2044FE3CE8E083C186136A40FB0904362829AD3E2044FE3C010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000C0000000100000052000000FFFFFFFF10008C1B1AB6B8C850C2F088583D000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF0000000000010000D14498C1547DFA3E05271536301E8240020000005100000000010000000100000006000000000000005000000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200E61B2DC178F85CC072ACA735DEDB6D3E2AF0E23E28C380C178F85CC004FFFA359E6EA93E2AF0E23E2CC380C12CAA3440F3BD0336A46EA93E50A7A23DE81B2DC19CDC4E40536FB135DEDB6D3E901B643D010C0000000000000001000000000000000600000001000000150201000200030000000000010002000102000000030000000B0000000100000056000000FFFFFFFF10003A83D8B5B8C850C20481E7BC000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100001F5157C1C0BDE1BD2C94D735E04188400200000055000000000100000001000000060000000000000054000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402009A57A3C03C8C5EC0E54A1B358173003E6EABE33E6EE026C14CD067C016A7A235D566663E92F7E73E6EE026C19CDC4E401349";
                    strNif22 = "AB35D566663E901B643D9A57A3C0DE7E2940C34336358173003ED05FB73D010C0000000000000001000000000000000600000001000000150201000000010002000200030000000102000000030000000A000000010000005A000000FFFFFFFF1000D4EE7DB5B8C850C2A0B522BD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100003B8CF8C0809D47BE86EE7835E8E08A40020000005900000000010000000100000006000000000000005800000000010000000200000007000000000000000800000000000000000000005000000000000000010000000000000004000000020000003704030036040200927EA63F3E8C5EC080DEFEB2F67EBA3B6EABE33EA8E096C03C8C5EC0E6371035E2FCF13D6EABE33EA8E096C0DE7E2940C4302B35E2FCF13DD05FB73D907EA63F07E92B40F2099433FD7EBA3B00E5B23D010C00000000000000010000000000000006000000010000001502010002000300000000000100020001020000000300000009000000010000005E000000FFFFFFFF1000D09F0EB4B8C850C2B8F888BD000080B4000080B3000080BF000080BF0000000000004034000080330000803F000000B40000803F050000006600000064000000630000006200000067000000FFFFFFFF00000000FFFFFFFF00000000000100000782DABFDC8CCABED039A334F2CC8940020000005D00000000010000000100000006000000000000005C000000000100000002000000070000000000000008000000000000000000000050000000000000000100000000000000040000000200000037040300360402000704B1C2967645C0AB222E376E9D2D3F2ECB643F688FB7C2EC6782C0285C3537223A3C3F703C743F698FB7C208256C4093733637223A3C3FF42FF63E0804B1C2716A7540B8D82F37739D2D3FD2AAF13E010C000000000000000100000000000000060000000100000015020100000001000200020003000000010500000000000000FFFFFFFF0000000000000000000000000000000000000000000000000000000000000000000000000000803F0000803F0000803F000020410000803FFFFFFFFF00000000FFFFFFFF0000FFFFFFFF00000000FFFFFFFFED1000FFFFFFFF00000000FFFFFFFF0104000000FFFFFFFF060000000100000003000000010000FFFFFFFF00000000FFFFFFFF04000900000001650000000032010000000000000000000000000000FFFFFFFF00000000FFFFFFFF0D000200000003000000010000000100000068000000FFFFFFFF10007D1136B7B8C850C2D4A3F2BC000080B400000000000080BF000080BF0000000000008034000000000000803F000000000000803F050000006200000063000000640000006600000067000000FFFFFFFF00000000FFFFFFFF0000000000010000B849B4C27056F6BD1F4B32377CF5884002000000610000000001000000010000000600000000000000600000000001000000020000000700000000000000080000000000000000000000FFFFFFFF00000000FFFFFFFF0800FFFFFFFF00000000FFFFFFFF0F000000000000000000FFFFFFFF10010000000000000000000000000000803F0000000000000000000000000000803F0000000000000000000000000000803F0000803F020000006A0000006B000000FFFFFFFF19000000690000005F0000005B00000057000000530000004F0000004B00000047000000430000003F0000003B00000037000000330000002F0000002B00000027000000230000001F0000001B00000017000000130000000F0000000B000000070000000300000000000000010000006C000000";
                    strNif2 = strNif21 + strNif22;
                }
            }
// Write the NIF file        
            string strNifHex = strNif1 + clsCMD.String2Hex(strNifPatch) + strNif2;
            string strNifFile = AppPath + NEWGUITARPACK + "\\assets\\gameplay\\inlay\\" + guitarnamesix + ".nif";
            File.WriteAllBytes(strNifFile, clsCMD.HexStr2ByteAry(strNifHex));
// Create DLC support files from templates 
            frmPbar.PbarFooter("Creating Support Files ...");
            frmPbar.PbarValue(70);
            clsDLC objDlc = new clsDLC();
            bRet = objDlc.CreateInlayDlc(guitarnamesix, txtGuitar.Text);
// Pack the DLC Inlay
            strGuitarName = txtGuitar.Text.Replace(" ", "_").ToLower();
            frmPbar.PbarFooter("Packing DLC Inlay ...");
            frmPbar.PbarValue(90);
            var target = new Platform(cmbPlatform.SelectedItem.ToString(), GameVersion.RS2014.ToString());
            strExePath = AppPath + "\\packer.exe";
            switch (target.platform)
            {
                case GamePlatform.Pc:
                    strSwitches = " --pack --input=\"" + AppPath + NEWGUITARPACK + "\" --platform=Pc --version=RS2014 --output=\"" + RSDIR + DLCINLAYS + "\\" + strGuitarName + "_p.psarc\"";
                    bRet = clsCMD.RunExtExe(strExePath, strSwitches);
                    break;
                case GamePlatform.Mac:
                    strSwitches = " --pack --input=\"" + AppPath + NEWGUITARPACK + "\" --platform=Mac --version=RS2014--output=\"" + RSDIR + DLCINLAYS + "\\" + strGuitarName + "_m.psarc\"";
                    bRet = clsCMD.RunExtExe(strExePath, strSwitches);
                    break;
                    /* Future Development
                case GamePlatform.XBox360:
                    strSwitches = " --pack --input=\"" + AppPath + NEWGUITARPACK + "\" --platform=XBox360 --version=RS2014 --output=\"" + RSDIR + DLCINLAYS + "\\" + strGuitarName + ".xbox360\"";
                    bRet = clsCMD.RunExtExe(strExePath, strSwitches);
                    break;
                case GamePlatform.PS3:
                    strSwitches = " --pack --input=\"" + AppPath + NEWGUITARPACK + "\" --platform=PS3 --version=RS2014 --output=\"" + RSDIR + DLCINLAYS + "\\" + strGuitarName + ".ps3\"";
                    bRet = clsCMD.RunExtExe(strExePath, strSwitches);
                    break;
                    */
                default:
                    MessageBox.Show("Sorry man!  Cozy1 hasn't programmed that feature yet.  Target Platform is not supported at this time.  Custom Guitar Inlay was not created.", MESSAGEBOX_CAPTION, MessageBoxButtons.OK, MessageBoxIcon.Warning);
                    break;
            }

            frmPbar.PbarFooter("All Done ...");
            frmPbar.PbarValue(100);
            Cursor.Current = Cursors.Default;
        }

        private void txtCreator_DoubleClick(object sender, EventArgs e)
        {
            // allow user input
            txtCreator.ForeColor = Color.Black;
            txtCreator.SelectAll();
        }

        private void txtInlay_DoubleClick(object sender, EventArgs e)
        {
            // allow user input
            txtGuitar.ForeColor = Color.Black;
            txtGuitar.SelectAll();
        }

        private void txtAppId_DoubleClick(object sender, EventArgs e)
        {
            // allow user input
            txtAppId.ForeColor = Color.Black;
            txtAppId.SelectAll();
        }

        private void chkFlipX_Click(object sender, EventArgs e)
        {
            string AppPath = Application.StartupPath;
            Cursor.Current = Cursors.WaitCursor;
            strExePath = AppPath + TOOLSDIR + "\\topng.exe";
            strSwitches = " -overwrite -xflip " + "\"" + strInlayFile + "\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            picInlay.ImageLocation = strInlayFile;
            Cursor.Current = Cursors.Default;
        }

        private void chkFlipY_Click(object sender, EventArgs e)
        {
            string AppPath = Application.StartupPath;
            Cursor.Current = Cursors.WaitCursor;
            strExePath = AppPath + TOOLSDIR + "\\topng.exe";
            strSwitches = " -overwrite -yflip " + "\"" + strInlayFile + "\"";
            bRet = clsCMD.RunExtExe(strExePath, strSwitches);
            picInlay.ImageLocation = strInlayFile;
            Cursor.Current = Cursors.Default;
        }

        public void ctrlCGM_Dispose(object sender, EventArgs e)
        {
            string AppPath = Application.StartupPath;
            string iniCGL = AppPath + "\\CGM\\CustomGuitarList.ini";
            var target = new Platform(cmbPlatform.SelectedItem.ToString(), GameVersion.RS2014.ToString());
            string strPlatform = target.platform.ToString();
            clsINI objIni = new clsINI();
            bRet = objIni.IniWrite(iniCGL, "CustomGuitarMaker", "Rocksmith2014dir", RSDIR);
            bRet = objIni.IniWrite(iniCGL, "CustomGuitarMaker", "Platform", strPlatform);
            // Delete tmp directory structure
            bRet = clsCMD.DeleteDir(AppPath + TMPDIR, true);
        }
    }
}